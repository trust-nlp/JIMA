/project/wli5/conda/envs/jima/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/project/wli5/conda/envs/jima/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet101_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet101_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Starting training...
Epoch 1/120
alternating training for epoch 1...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 4.7858
Entity Batch [20/65] - Loss: 0.4421
Report Batch [40/65] - Loss: 4.0612
Entity Batch [40/65] - Loss: 0.1002
Report Batch [60/65] - Loss: 3.5143
Entity Batch [60/65] - Loss: 0.0844
Epoch Summary - Report Loss: 4.3410, Entity Loss: 0.2849, Total Loss: 2.2132
Epoch 1 - Train Loss: 2.2132, Val Loss: 3.3144
BLEU_1: 0.1576
BLEU_2: 0.0991
BLEU_3: 0.0680
BLEU_4: 0.0484
METEOR: 0.0920
ROUGE_L: 0.2916
entity_precision: 0.6499
entity_recall: 0.3150
entity_f1: 0.4243
Saving best model with BLEU_4: 0.0484
Epoch 2/120
alternating training for epoch 2...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 3.3759
Entity Batch [20/65] - Loss: 0.0730
Report Batch [40/65] - Loss: 2.8980
Entity Batch [40/65] - Loss: 0.0665
Report Batch [60/65] - Loss: 2.7269
Entity Batch [60/65] - Loss: 0.0746
Epoch Summary - Report Loss: 2.9877, Entity Loss: 0.0707, Total Loss: 1.5045
Epoch 2 - Train Loss: 1.5045, Val Loss: 2.6806
BLEU_1: 0.2582
BLEU_2: 0.1410
BLEU_3: 0.0954
BLEU_4: 0.0704
METEOR: 0.1024
ROUGE_L: 0.3043
entity_precision: 0.6584
entity_recall: 0.3045
entity_f1: 0.4165
Saving best model with BLEU_4: 0.0704
Epoch 3/120
alternating training for epoch 3...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 2.7719
Entity Batch [20/65] - Loss: 0.0680
Report Batch [40/65] - Loss: 2.4185
Entity Batch [40/65] - Loss: 0.0634
Report Batch [60/65] - Loss: 2.3284
Entity Batch [60/65] - Loss: 0.0713
Epoch Summary - Report Loss: 2.4330, Entity Loss: 0.0666, Total Loss: 1.2265
Epoch 3 - Train Loss: 1.2265, Val Loss: 2.4269
BLEU_1: 0.2691
BLEU_2: 0.1518
BLEU_3: 0.1052
BLEU_4: 0.0794
METEOR: 0.1086
ROUGE_L: 0.3057
entity_precision: 0.6742
entity_recall: 0.2888
entity_f1: 0.4044
Saving best model with BLEU_4: 0.0794
Epoch 4/120
alternating training for epoch 4...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 2.3912
Entity Batch [20/65] - Loss: 0.0652
Report Batch [40/65] - Loss: 2.1164
Entity Batch [40/65] - Loss: 0.0611
Report Batch [60/65] - Loss: 1.9698
Entity Batch [60/65] - Loss: 0.0709
Epoch Summary - Report Loss: 2.0780, Entity Loss: 0.0644, Total Loss: 1.0487
Epoch 4 - Train Loss: 1.0487, Val Loss: 2.2666
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6688
entity_recall: 0.2943
entity_f1: 0.4088
Epoch 5/120
alternating training for epoch 5...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 2.0619
Entity Batch [20/65] - Loss: 0.0645
Report Batch [40/65] - Loss: 1.8117
Entity Batch [40/65] - Loss: 0.0603
Report Batch [60/65] - Loss: 1.6921
Entity Batch [60/65] - Loss: 0.0683
Epoch Summary - Report Loss: 1.7826, Entity Loss: 0.0633, Total Loss: 0.9008
Epoch 5 - Train Loss: 0.9008, Val Loss: 2.2064
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6671
entity_recall: 0.2986
entity_f1: 0.4126
Epoch 6/120
alternating training for epoch 6...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.7846
Entity Batch [20/65] - Loss: 0.0624
Report Batch [40/65] - Loss: 1.5686
Entity Batch [40/65] - Loss: 0.0583
Report Batch [60/65] - Loss: 1.4138
Entity Batch [60/65] - Loss: 0.0667
Epoch Summary - Report Loss: 1.5166, Entity Loss: 0.0617, Total Loss: 0.7675
Epoch 6 - Train Loss: 0.7675, Val Loss: 2.2460
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6656
entity_recall: 0.2990
entity_f1: 0.4127
Epoch 7/120
alternating training for epoch 7...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.5299
Entity Batch [20/65] - Loss: 0.0613
Report Batch [40/65] - Loss: 1.2970
Entity Batch [40/65] - Loss: 0.0567
Report Batch [60/65] - Loss: 1.1836
Entity Batch [60/65] - Loss: 0.0664
Epoch Summary - Report Loss: 1.2736, Entity Loss: 0.0605, Total Loss: 0.6459
Epoch 7 - Train Loss: 0.6459, Val Loss: 2.2371
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6658
entity_recall: 0.3037
entity_f1: 0.4171
Epoch 8/120
alternating training for epoch 8...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.2559
Entity Batch [20/65] - Loss: 0.0603
Report Batch [40/65] - Loss: 1.0809
Entity Batch [40/65] - Loss: 0.0553
Report Batch [60/65] - Loss: 1.0160
Entity Batch [60/65] - Loss: 0.0650
Epoch Summary - Report Loss: 1.0468, Entity Loss: 0.0596, Total Loss: 0.5324
Epoch 8 - Train Loss: 0.5324, Val Loss: 2.3579
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6668
entity_recall: 0.3002
entity_f1: 0.4141
Epoch 9/120
alternating training for epoch 9...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.0640
Entity Batch [20/65] - Loss: 0.0591
Report Batch [40/65] - Loss: 0.8967
Entity Batch [40/65] - Loss: 0.0541
Report Batch [60/65] - Loss: 0.8092
Entity Batch [60/65] - Loss: 0.0650
Epoch Summary - Report Loss: 0.8694, Entity Loss: 0.0584, Total Loss: 0.4435
Epoch 9 - Train Loss: 0.4435, Val Loss: 2.3785
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6600
entity_recall: 0.3047
entity_f1: 0.4170
Epoch 10/120
alternating training for epoch 10...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 0.8669
Entity Batch [20/65] - Loss: 0.0579
Report Batch [40/65] - Loss: 0.7013
Entity Batch [40/65] - Loss: 0.0531
Report Batch [60/65] - Loss: 0.6203
Entity Batch [60/65] - Loss: 0.0642
Epoch Summary - Report Loss: 0.6818, Entity Loss: 0.0571, Total Loss: 0.3495
Epoch 10 - Train Loss: 0.3495, Val Loss: 2.5417
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6709
entity_recall: 0.2833
entity_f1: 0.3983
Epoch 11/120
alternating training for epoch 11...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 0.7086
Entity Batch [20/65] - Loss: 0.0566
Report Batch [40/65] - Loss: 0.5653
Entity Batch [40/65] - Loss: 0.0527
Report Batch [60/65] - Loss: 0.4789
Entity Batch [60/65] - Loss: 0.0614
Epoch Summary - Report Loss: 0.5432, Entity Loss: 0.0557, Total Loss: 0.2800
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 1.0000
Epoch 11 - Train Loss: 0.2800, Val Loss: 2.5656
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6594
entity_recall: 0.2916
entity_f1: 0.4044
Epoch 12/120
alternating training for epoch 12...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 0.5752
Entity Batch [20/65] - Loss: 0.0558
Report Batch [40/65] - Loss: 0.4515
Entity Batch [40/65] - Loss: 0.0498
Report Batch [60/65] - Loss: 0.3671
Entity Batch [60/65] - Loss: 0.0602
Epoch Summary - Report Loss: 0.4248, Entity Loss: 0.0543, Total Loss: 0.2205
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 1.0000
Epoch 12 - Train Loss: 0.2205, Val Loss: 2.5805
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6398
entity_recall: 0.3043
entity_f1: 0.4125
Epoch 13/120
alternating training for epoch 13...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 0.4366
Entity Batch [20/65] - Loss: 0.0540
Report Batch [40/65] - Loss: 0.3458
Entity Batch [40/65] - Loss: 0.0496
Report Batch [60/65] - Loss: 0.2824
Entity Batch [60/65] - Loss: 0.0605
Epoch Summary - Report Loss: 0.3194, Entity Loss: 0.0532, Total Loss: 0.1677
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9843
Epoch 13 - Train Loss: 0.1677, Val Loss: 2.7261
BLEU_1: 0.2013
BLEU_2: 0.1202
BLEU_3: 0.0850
BLEU_4: 0.0650
METEOR: 0.1045
ROUGE_L: 0.2955
entity_precision: 0.6603
entity_recall: 0.2951
entity_f1: 0.4079
Epoch 14/120
alternating training for epoch 14...
Report batches: 64, Entity batches: 64
Report Batch [20/64] - Loss: 2.1395
Entity Batch [20/64] - Loss: 0.0551
Report Batch [40/64] - Loss: 1.8203
Entity Batch [40/64] - Loss: 0.0651
Report Batch [60/64] - Loss: 1.9070
Entity Batch [60/64] - Loss: 0.0638
Epoch Summary - Report Loss: 1.9738, Entity Loss: 0.0613, Total Loss: 0.9961
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9995
Epoch 14 - Train Loss: 0.9961, Val Loss: 1.9566
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6878
entity_recall: 0.2814
entity_f1: 0.3994
Epoch 15/120
alternating training for epoch 15...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.7413
Entity Batch [20/65] - Loss: 0.0619
Report Batch [40/65] - Loss: 1.8395
Entity Batch [40/65] - Loss: 0.0612
Report Batch [60/65] - Loss: 1.7782
Entity Batch [60/65] - Loss: 0.0577
Epoch Summary - Report Loss: 1.7969, Entity Loss: 0.0611, Total Loss: 0.9076
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9995
Epoch 15 - Train Loss: 0.9076, Val Loss: 1.8441
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6770
entity_recall: 0.2861
entity_f1: 0.4022
Epoch 16/120
alternating training for epoch 16...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.6253
Entity Batch [20/65] - Loss: 0.0596
Report Batch [40/65] - Loss: 1.6407
Entity Batch [40/65] - Loss: 0.0669
Report Batch [60/65] - Loss: 1.6367
Entity Batch [60/65] - Loss: 0.0538
Epoch Summary - Report Loss: 1.7044, Entity Loss: 0.0606, Total Loss: 0.8613
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9995
Epoch 16 - Train Loss: 0.8613, Val Loss: 1.7686
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6792
entity_recall: 0.2894
entity_f1: 0.4059
Epoch 17/120
alternating training for epoch 17...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.5389
Entity Batch [20/65] - Loss: 0.0579
Report Batch [40/65] - Loss: 1.5832
Entity Batch [40/65] - Loss: 0.0644
Report Batch [60/65] - Loss: 1.6872
Entity Batch [60/65] - Loss: 0.0559
Epoch Summary - Report Loss: 1.6395, Entity Loss: 0.0601, Total Loss: 0.8288
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9995
Epoch 17 - Train Loss: 0.8288, Val Loss: 1.7587
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6746
entity_recall: 0.2957
entity_f1: 0.4112
Epoch 18/120
alternating training for epoch 18...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.4252
Entity Batch [20/65] - Loss: 0.0606
Report Batch [40/65] - Loss: 1.6829
Entity Batch [40/65] - Loss: 0.0657
Report Batch [60/65] - Loss: 1.5036
Entity Batch [60/65] - Loss: 0.0555
Epoch Summary - Report Loss: 1.5807, Entity Loss: 0.0596, Total Loss: 0.7993
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 1.0000
Epoch 18 - Train Loss: 0.7993, Val Loss: 1.7198
BLEU_1: 0.1986
BLEU_2: 0.1176
BLEU_3: 0.0832
BLEU_4: 0.0636
METEOR: 0.1032
ROUGE_L: 0.2944
entity_precision: 0.6696
entity_recall: 0.2941
entity_f1: 0.4087
Epoch 19/120
alternating training for epoch 19...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 0.6089
Entity Batch [20/65] - Loss: 0.0554
Report Batch [40/65] - Loss: 0.4432
Entity Batch [40/65] - Loss: 0.0502
Report Batch [60/65] - Loss: 0.3352
Entity Batch [60/65] - Loss: 0.0587
Epoch Summary - Report Loss: 0.4604, Entity Loss: 0.0536, Total Loss: 0.2383
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9942
Epoch 19 - Train Loss: 0.2383, Val Loss: 2.0301
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6614
entity_recall: 0.2994
entity_f1: 0.4122
Epoch 20/120
alternating training for epoch 20...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.5257
Entity Batch [20/65] - Loss: 0.0507
Report Batch [40/65] - Loss: 1.7597
Entity Batch [40/65] - Loss: 0.0579
Report Batch [60/65] - Loss: 1.7902
Entity Batch [60/65] - Loss: 0.0625
Epoch Summary - Report Loss: 1.5837, Entity Loss: 0.0594, Total Loss: 0.8008
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9943
Epoch 20 - Train Loss: 0.8008, Val Loss: 1.7202
BLEU_1: 0.1988
BLEU_2: 0.1180
BLEU_3: 0.0835
BLEU_4: 0.0640
METEOR: 0.1034
ROUGE_L: 0.2946
entity_precision: 0.6850
entity_recall: 0.2675
entity_f1: 0.3848
Epoch 21/120
alternating training for epoch 21...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 1.6014
Entity Batch [20/65] - Loss: 0.0610
Report Batch [40/65] - Loss: 1.4288
Entity Batch [40/65] - Loss: 0.0610
Report Batch [60/65] - Loss: 1.4062
Entity Batch [60/65] - Loss: 0.0593
Epoch Summary - Report Loss: 1.5005, Entity Loss: 0.0585, Total Loss: 0.7590
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9276
Epoch 21 - Train Loss: 0.7590, Val Loss: 1.6814
BLEU_1: 0.2159
BLEU_2: 0.1279
BLEU_3: 0.0897
BLEU_4: 0.0683
METEOR: 0.1068
ROUGE_L: 0.2963
entity_precision: 0.6677
entity_recall: 0.2953
entity_f1: 0.4095
Epoch 22/120
alternating training for epoch 22...
Report batches: 60, Entity batches: 60
Report Batch [20/60] - Loss: 1.5470
Entity Batch [20/60] - Loss: 0.0534
Report Batch [40/60] - Loss: 1.4949
Entity Batch [40/60] - Loss: 0.0494
Report Batch [60/60] - Loss: 1.3452
Entity Batch [60/60] - Loss: 0.0597
Epoch Summary - Report Loss: 1.3424, Entity Loss: 0.0552, Total Loss: 0.6795
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9858
Epoch 22 - Train Loss: 0.6795, Val Loss: 1.6736
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6721
entity_recall: 0.2933
entity_f1: 0.4084
Epoch 23/120
alternating training for epoch 23...
Report batches: 64, Entity batches: 64
Report Batch [20/64] - Loss: 1.6539
Entity Batch [20/64] - Loss: 0.0542
Report Batch [40/64] - Loss: 1.5815
Entity Batch [40/64] - Loss: 0.0620
Report Batch [60/64] - Loss: 1.4587
Entity Batch [60/64] - Loss: 0.0573
Epoch Summary - Report Loss: 1.3950, Entity Loss: 0.0574, Total Loss: 0.7061
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9858
Epoch 23 - Train Loss: 0.7061, Val Loss: 1.6561
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6911
entity_recall: 0.2702
entity_f1: 0.3885
Epoch 24/120
alternating training for epoch 24...
Report batches: 64, Entity batches: 64
Report Batch [20/64] - Loss: 1.6648
Entity Batch [20/64] - Loss: 0.0580
Report Batch [40/64] - Loss: 1.6307
Entity Batch [40/64] - Loss: 0.0592
Report Batch [60/64] - Loss: 1.4351
Entity Batch [60/64] - Loss: 0.0565
Epoch Summary - Report Loss: 1.3551, Entity Loss: 0.0570, Total Loss: 0.6861
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 1.0000
Epoch 24 - Train Loss: 0.6861, Val Loss: 1.6532
BLEU_1: 0.1966
BLEU_2: 0.1145
BLEU_3: 0.0798
BLEU_4: 0.0604
METEOR: 0.1009
ROUGE_L: 0.2920
entity_precision: 0.6380
entity_recall: 0.3009
entity_f1: 0.4089
Epoch 25/120
alternating training for epoch 25...
Report batches: 65, Entity batches: 65
Report Batch [20/65] - Loss: 0.5313
Entity Batch [20/65] - Loss: 0.0541
Report Batch [40/65] - Loss: 0.3990
Entity Batch [40/65] - Loss: 0.0488
Report Batch [60/65] - Loss: 0.3020
Entity Batch [60/65] - Loss: 0.0581
Epoch Summary - Report Loss: 0.3963, Entity Loss: 0.0524, Total Loss: 0.2060
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.9410
Epoch 25 - Train Loss: 0.2060, Val Loss: 1.8943
BLEU_1: 0.1989
BLEU_2: 0.1180
BLEU_3: 0.0836
BLEU_4: 0.0640
METEOR: 0.1035
ROUGE_L: 0.2947
entity_precision: 0.6438
entity_recall: 0.3070
entity_f1: 0.4157
Epoch 26/120
alternating training for epoch 26...
Report batches: 61, Entity batches: 61
Report Batch [20/61] - Loss: 1.2367
Entity Batch [20/61] - Loss: 0.0639
Report Batch [40/61] - Loss: 1.3163
Entity Batch [40/61] - Loss: 0.0588
Report Batch [60/61] - Loss: 1.3096
Entity Batch [60/61] - Loss: 0.0563
Epoch Summary - Report Loss: 1.3045, Entity Loss: 0.0551, Total Loss: 0.6605
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.8714
Epoch 26 - Train Loss: 0.6605, Val Loss: 1.6640
BLEU_1: 0.2167
BLEU_2: 0.1287
BLEU_3: 0.0903
BLEU_4: 0.0687
METEOR: 0.1071
ROUGE_L: 0.2963
entity_precision: 0.6699
entity_recall: 0.2849
entity_f1: 0.3998
Epoch 27/120
alternating training for epoch 27...
Report batches: 57, Entity batches: 57
Report Batch [20/57] - Loss: 1.1065
Entity Batch [20/57] - Loss: 0.0489
Report Batch [40/57] - Loss: 1.1941
Entity Batch [40/57] - Loss: 0.0491
Epoch Summary - Report Loss: 1.1444, Entity Loss: 0.0515, Total Loss: 0.5800
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.8880
Epoch 27 - Train Loss: 0.5800, Val Loss: 1.6536
BLEU_1: 0.2115
BLEU_2: 0.1256
BLEU_3: 0.0885
BLEU_4: 0.0674
METEOR: 0.1062
ROUGE_L: 0.2952
entity_precision: 0.6515
entity_recall: 0.3015
entity_f1: 0.4122
Epoch 28/120
alternating training for epoch 28...
Report batches: 58, Entity batches: 58
Report Batch [20/58] - Loss: 1.2050
Entity Batch [20/58] - Loss: 0.0522
Report Batch [40/58] - Loss: 1.0841
Entity Batch [40/58] - Loss: 0.0498
Epoch Summary - Report Loss: 1.1326, Entity Loss: 0.0516, Total Loss: 0.5740
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.8424
Epoch 28 - Train Loss: 0.5740, Val Loss: 1.6462
BLEU_1: 0.2251
BLEU_2: 0.1334
BLEU_3: 0.0936
BLEU_4: 0.0709
METEOR: 0.1083
ROUGE_L: 0.2963
entity_precision: 0.6618
entity_recall: 0.2808
entity_f1: 0.3943
Epoch 29/120
alternating training for epoch 29...
Report batches: 55, Entity batches: 55
Report Batch [20/55] - Loss: 1.0809
Entity Batch [20/55] - Loss: 0.0493
Report Batch [40/55] - Loss: 1.1665
Entity Batch [40/55] - Loss: 0.0507
Epoch Summary - Report Loss: 1.0552, Entity Loss: 0.0496, Total Loss: 0.5351
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.5992
Epoch 29 - Train Loss: 0.5351, Val Loss: 1.6602
BLEU_1: 0.3860
BLEU_2: 0.2101
BLEU_3: 0.1337
BLEU_4: 0.0914
METEOR: 0.1424
ROUGE_L: 0.3045
entity_precision: 0.6784
entity_recall: 0.2724
entity_f1: 0.3887
Saving best model with BLEU_4: 0.0914
Epoch 30/120
alternating training for epoch 30...
Report batches: 39, Entity batches: 39
Report Batch [20/39] - Loss: 0.8392
Entity Batch [20/39] - Loss: 0.0407
Epoch Summary - Report Loss: 0.7532, Entity Loss: 0.0408, Total Loss: 0.3827
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.3938
Epoch 30 - Train Loss: 0.3827, Val Loss: 1.6718
BLEU_1: 0.3966
BLEU_2: 0.2418
BLEU_3: 0.1670
BLEU_4: 0.1227
METEOR: 0.1546
ROUGE_L: 0.3182
entity_precision: 0.6654
entity_recall: 0.2914
entity_f1: 0.4054
Saving best model with BLEU_4: 0.1227
Epoch 31/120
alternating training for epoch 31...
Report batches: 26, Entity batches: 26
Report Batch [20/26] - Loss: 0.5095
Entity Batch [20/26] - Loss: 0.0324
Epoch Summary - Report Loss: 0.5186, Entity Loss: 0.0328, Total Loss: 0.2642
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.5497
Epoch 31 - Train Loss: 0.2642, Val Loss: 1.7340
BLEU_1: 0.2407
BLEU_2: 0.1425
BLEU_3: 0.0988
BLEU_4: 0.0741
METEOR: 0.1139
ROUGE_L: 0.2965
entity_precision: 0.6536
entity_recall: 0.2761
entity_f1: 0.3882
Epoch 32/120
alternating training for epoch 32...
Report batches: 36, Entity batches: 36
Report Batch [20/36] - Loss: 0.6920
Entity Batch [20/36] - Loss: 0.0354
Epoch Summary - Report Loss: 0.6634, Entity Loss: 0.0381, Total Loss: 0.3374
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.3971
Epoch 32 - Train Loss: 0.3374, Val Loss: 1.7107
BLEU_1: 0.2993
BLEU_2: 0.1822
BLEU_3: 0.1276
BLEU_4: 0.0947
METEOR: 0.1267
ROUGE_L: 0.3086
entity_precision: 0.6362
entity_recall: 0.2882
entity_f1: 0.3967
Epoch 33/120
alternating training for epoch 33...
Report batches: 26, Entity batches: 26
Report Batch [20/26] - Loss: 0.4449
Entity Batch [20/26] - Loss: 0.0310
Epoch Summary - Report Loss: 0.4879, Entity Loss: 0.0318, Total Loss: 0.2487
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.4856
Epoch 33 - Train Loss: 0.2487, Val Loss: 1.7354
BLEU_1: 0.2314
BLEU_2: 0.1394
BLEU_3: 0.0979
BLEU_4: 0.0736
METEOR: 0.1112
ROUGE_L: 0.2988
entity_precision: 0.6198
entity_recall: 0.3123
entity_f1: 0.4154
Epoch 34/120
alternating training for epoch 34...
Report batches: 32, Entity batches: 32
Report Batch [20/32] - Loss: 0.6696
Entity Batch [20/32] - Loss: 0.0346
Epoch Summary - Report Loss: 0.5634, Entity Loss: 0.0351, Total Loss: 0.2870
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2815
Epoch 34 - Train Loss: 0.2870, Val Loss: 1.7348
BLEU_1: 0.3470
BLEU_2: 0.2126
BLEU_3: 0.1457
BLEU_4: 0.1045
METEOR: 0.1388
ROUGE_L: 0.3098
entity_precision: 0.6047
entity_recall: 0.2896
entity_f1: 0.3916
Epoch 35/120
alternating training for epoch 35...
Report batches: 19, Entity batches: 19
Epoch Summary - Report Loss: 0.3579, Entity Loss: 0.0285, Total Loss: 0.1832
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2993
Epoch 35 - Train Loss: 0.1832, Val Loss: 1.8052
BLEU_1: 0.3126
BLEU_2: 0.1897
BLEU_3: 0.1321
BLEU_4: 0.0979
METEOR: 0.1319
ROUGE_L: 0.3040
entity_precision: 0.6286
entity_recall: 0.3072
entity_f1: 0.4127
Epoch 36/120
alternating training for epoch 36...
Report batches: 20, Entity batches: 20
Report Batch [20/20] - Loss: 0.3844
Entity Batch [20/20] - Loss: 0.0267
Epoch Summary - Report Loss: 0.3593, Entity Loss: 0.0277, Total Loss: 0.1838
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2989
Epoch 36 - Train Loss: 0.1838, Val Loss: 1.8116
BLEU_1: 0.3226
BLEU_2: 0.1944
BLEU_3: 0.1341
BLEU_4: 0.0981
METEOR: 0.1335
ROUGE_L: 0.3028
entity_precision: 0.6191
entity_recall: 0.2990
entity_f1: 0.4033
Epoch 37/120
alternating training for epoch 37...
Report batches: 20, Entity batches: 20
Report Batch [20/20] - Loss: 0.3002
Entity Batch [20/20] - Loss: 0.0254
Epoch Summary - Report Loss: 0.3468, Entity Loss: 0.0265, Total Loss: 0.1774
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2347
Epoch 37 - Train Loss: 0.1774, Val Loss: 1.8395
BLEU_1: 0.3940
BLEU_2: 0.2386
BLEU_3: 0.1635
BLEU_4: 0.1191
METEOR: 0.1589
ROUGE_L: 0.3208
entity_precision: 0.5937
entity_recall: 0.3191
entity_f1: 0.4151
Epoch 38/120
alternating training for epoch 38...
Report batches: 16, Entity batches: 16
Epoch Summary - Report Loss: 0.2940, Entity Loss: 0.0242, Total Loss: 0.1506
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2763
Epoch 38 - Train Loss: 0.1506, Val Loss: 1.8626
BLEU_1: 0.2996
BLEU_2: 0.1819
BLEU_3: 0.1285
BLEU_4: 0.0980
METEOR: 0.1313
ROUGE_L: 0.3145
entity_precision: 0.6047
entity_recall: 0.2980
entity_f1: 0.3992
Epoch 39/120
alternating training for epoch 39...
Report batches: 18, Entity batches: 18
Epoch Summary - Report Loss: 0.3108, Entity Loss: 0.0253, Total Loss: 0.1592
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.3563
Epoch 39 - Train Loss: 0.1592, Val Loss: 1.8730
BLEU_1: 0.2573
BLEU_2: 0.1454
BLEU_3: 0.0965
BLEU_4: 0.0696
METEOR: 0.1161
ROUGE_L: 0.2921
entity_precision: 0.6115
entity_recall: 0.3013
entity_f1: 0.4037
Epoch 40/120
alternating training for epoch 40...
Report batches: 24, Entity batches: 24
Report Batch [20/24] - Loss: 0.4113
Entity Batch [20/24] - Loss: 0.0348
Epoch Summary - Report Loss: 0.3838, Entity Loss: 0.0292, Total Loss: 0.1963
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2348
Epoch 40 - Train Loss: 0.1963, Val Loss: 1.8800
BLEU_1: 0.3459
BLEU_2: 0.2004
BLEU_3: 0.1325
BLEU_4: 0.0933
METEOR: 0.1383
ROUGE_L: 0.2964
entity_precision: 0.5820
entity_recall: 0.3314
entity_f1: 0.4223
Epoch 41/120
alternating training for epoch 41...
Report batches: 16, Entity batches: 16
Epoch Summary - Report Loss: 0.2907, Entity Loss: 0.0234, Total Loss: 0.1489
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2461
Epoch 41 - Train Loss: 0.1489, Val Loss: 1.8579
BLEU_1: 0.3095
BLEU_2: 0.1803
BLEU_3: 0.1213
BLEU_4: 0.0888
METEOR: 0.1317
ROUGE_L: 0.3063
entity_precision: 0.6021
entity_recall: 0.3109
entity_f1: 0.4100
Epoch 42/120
alternating training for epoch 42...
Report batches: 16, Entity batches: 16
Epoch Summary - Report Loss: 0.2786, Entity Loss: 0.0236, Total Loss: 0.1428
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2714
Epoch 42 - Train Loss: 0.1428, Val Loss: 1.9086
BLEU_1: 0.2742
BLEU_2: 0.1609
BLEU_3: 0.1085
BLEU_4: 0.0797
METEOR: 0.1234
ROUGE_L: 0.3032
entity_precision: 0.5826
entity_recall: 0.3103
entity_f1: 0.4049
Epoch 43/120
alternating training for epoch 43...
Report batches: 18, Entity batches: 18
Epoch Summary - Report Loss: 0.2835, Entity Loss: 0.0237, Total Loss: 0.1453
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2287
Epoch 43 - Train Loss: 0.1453, Val Loss: 1.9070
BLEU_1: 0.3067
BLEU_2: 0.1851
BLEU_3: 0.1263
BLEU_4: 0.0923
METEOR: 0.1341
ROUGE_L: 0.3088
entity_precision: 0.6214
entity_recall: 0.2929
entity_f1: 0.3981
Epoch 44/120
alternating training for epoch 44...
Report batches: 15, Entity batches: 15
Epoch Summary - Report Loss: 0.2508, Entity Loss: 0.0218, Total Loss: 0.1287
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1926
Epoch 44 - Train Loss: 0.1287, Val Loss: 1.9424
BLEU_1: 0.3528
BLEU_2: 0.2115
BLEU_3: 0.1446
BLEU_4: 0.1068
METEOR: 0.1479
ROUGE_L: 0.3204
entity_precision: 0.6176
entity_recall: 0.2859
entity_f1: 0.3909
Epoch 45/120
alternating training for epoch 45...
Report batches: 13, Entity batches: 13
Epoch Summary - Report Loss: 0.2270, Entity Loss: 0.0201, Total Loss: 0.1165
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1822
Epoch 45 - Train Loss: 0.1165, Val Loss: 1.9152
BLEU_1: 0.3521
BLEU_2: 0.2179
BLEU_3: 0.1510
BLEU_4: 0.1126
METEOR: 0.1509
ROUGE_L: 0.3285
entity_precision: 0.6117
entity_recall: 0.2964
entity_f1: 0.3993
Epoch 46/120
alternating training for epoch 46...
Report batches: 12, Entity batches: 12
Epoch Summary - Report Loss: 0.2217, Entity Loss: 0.0190, Total Loss: 0.1137
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1691
Epoch 46 - Train Loss: 0.1137, Val Loss: 1.9572
BLEU_1: 0.4175
BLEU_2: 0.2582
BLEU_3: 0.1736
BLEU_4: 0.1207
METEOR: 0.1648
ROUGE_L: 0.3334
entity_precision: 0.6249
entity_recall: 0.2851
entity_f1: 0.3916
Epoch 47/120
alternating training for epoch 47...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.2025, Entity Loss: 0.0178, Total Loss: 0.1039
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1525
Epoch 47 - Train Loss: 0.1039, Val Loss: 2.0004
BLEU_1: 0.4003
BLEU_2: 0.2491
BLEU_3: 0.1761
BLEU_4: 0.1325
METEOR: 0.1627
ROUGE_L: 0.3392
entity_precision: 0.6122
entity_recall: 0.2953
entity_f1: 0.3985
Saving best model with BLEU_4: 0.1325
Epoch 48/120
alternating training for epoch 48...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1821, Entity Loss: 0.0163, Total Loss: 0.0935
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1715
Epoch 48 - Train Loss: 0.0935, Val Loss: 1.9939
BLEU_1: 0.3838
BLEU_2: 0.2338
BLEU_3: 0.1597
BLEU_4: 0.1160
METEOR: 0.1575
ROUGE_L: 0.3253
entity_precision: 0.6096
entity_recall: 0.2943
entity_f1: 0.3970
Epoch 49/120
alternating training for epoch 49...
Report batches: 12, Entity batches: 12
Epoch Summary - Report Loss: 0.2040, Entity Loss: 0.0179, Total Loss: 0.1047
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1662
Epoch 49 - Train Loss: 0.1047, Val Loss: 1.9798
BLEU_1: 0.4087
BLEU_2: 0.2507
BLEU_3: 0.1701
BLEU_4: 0.1196
METEOR: 0.1641
ROUGE_L: 0.3290
entity_precision: 0.5959
entity_recall: 0.2779
entity_f1: 0.3791
Epoch 50/120
alternating training for epoch 50...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.2073, Entity Loss: 0.0170, Total Loss: 0.1062
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1555
Epoch 50 - Train Loss: 0.1062, Val Loss: 2.0014
BLEU_1: 0.4050
BLEU_2: 0.2509
BLEU_3: 0.1740
BLEU_4: 0.1273
METEOR: 0.1653
ROUGE_L: 0.3325
entity_precision: 0.6038
entity_recall: 0.3023
entity_f1: 0.4029
Epoch 51/120
alternating training for epoch 51...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1867, Entity Loss: 0.0172, Total Loss: 0.0959
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1582
Epoch 51 - Train Loss: 0.0959, Val Loss: 1.9964
BLEU_1: 0.4037
BLEU_2: 0.2484
BLEU_3: 0.1715
BLEU_4: 0.1251
METEOR: 0.1642
ROUGE_L: 0.3333
entity_precision: 0.5813
entity_recall: 0.3037
entity_f1: 0.3990
Epoch 52/120
alternating training for epoch 52...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1825, Entity Loss: 0.0158, Total Loss: 0.0936
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1712
Epoch 52 - Train Loss: 0.0936, Val Loss: 1.9948
BLEU_1: 0.4090
BLEU_2: 0.2464
BLEU_3: 0.1642
BLEU_4: 0.1148
METEOR: 0.1678
ROUGE_L: 0.3303
entity_precision: 0.5884
entity_recall: 0.3168
entity_f1: 0.4119
Epoch 53/120
alternating training for epoch 53...
Report batches: 12, Entity batches: 12
Epoch Summary - Report Loss: 0.1904, Entity Loss: 0.0159, Total Loss: 0.0976
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1697
Epoch 53 - Train Loss: 0.0976, Val Loss: 2.0053
BLEU_1: 0.4013
BLEU_2: 0.2438
BLEU_3: 0.1645
BLEU_4: 0.1158
METEOR: 0.1631
ROUGE_L: 0.3286
entity_precision: 0.6036
entity_recall: 0.3017
entity_f1: 0.4023
Epoch 54/120
alternating training for epoch 54...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1845, Entity Loss: 0.0154, Total Loss: 0.0945
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1721
Epoch 54 - Train Loss: 0.0945, Val Loss: 2.0016
BLEU_1: 0.4046
BLEU_2: 0.2445
BLEU_3: 0.1638
BLEU_4: 0.1142
METEOR: 0.1637
ROUGE_L: 0.3269
entity_precision: 0.6059
entity_recall: 0.3002
entity_f1: 0.4015
Epoch 55/120
alternating training for epoch 55...
Report batches: 12, Entity batches: 12
Epoch Summary - Report Loss: 0.1827, Entity Loss: 0.0161, Total Loss: 0.0938
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1665
Epoch 55 - Train Loss: 0.0938, Val Loss: 2.0071
BLEU_1: 0.4244
BLEU_2: 0.2574
BLEU_3: 0.1710
BLEU_4: 0.1179
METEOR: 0.1704
ROUGE_L: 0.3291
entity_precision: 0.5982
entity_recall: 0.3135
entity_f1: 0.4114
Epoch 56/120
alternating training for epoch 56...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1776, Entity Loss: 0.0155, Total Loss: 0.0911
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.2063
Epoch 56 - Train Loss: 0.0911, Val Loss: 2.0128
BLEU_1: 0.3566
BLEU_2: 0.2066
BLEU_3: 0.1333
BLEU_4: 0.0897
METEOR: 0.1478
ROUGE_L: 0.3109
entity_precision: 0.6050
entity_recall: 0.2994
entity_f1: 0.4006
Epoch 57/120
alternating training for epoch 57...
Report batches: 14, Entity batches: 14
Epoch Summary - Report Loss: 0.2103, Entity Loss: 0.0180, Total Loss: 0.1078
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1666
Epoch 57 - Train Loss: 0.1078, Val Loss: 2.0063
BLEU_1: 0.3811
BLEU_2: 0.2278
BLEU_3: 0.1518
BLEU_4: 0.1070
METEOR: 0.1574
ROUGE_L: 0.3227
entity_precision: 0.5989
entity_recall: 0.2992
entity_f1: 0.3991
Epoch 58/120
alternating training for epoch 58...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1756, Entity Loss: 0.0151, Total Loss: 0.0901
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1544
Epoch 58 - Train Loss: 0.0901, Val Loss: 2.0027
BLEU_1: 0.3935
BLEU_2: 0.2388
BLEU_3: 0.1613
BLEU_4: 0.1148
METEOR: 0.1618
ROUGE_L: 0.3272
entity_precision: 0.6061
entity_recall: 0.2900
entity_f1: 0.3923
Epoch 59/120
alternating training for epoch 59...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1672, Entity Loss: 0.0142, Total Loss: 0.0857
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1577
Epoch 59 - Train Loss: 0.0857, Val Loss: 2.0054
BLEU_1: 0.4047
BLEU_2: 0.2437
BLEU_3: 0.1620
BLEU_4: 0.1124
METEOR: 0.1649
ROUGE_L: 0.3276
entity_precision: 0.6045
entity_recall: 0.3000
entity_f1: 0.4010
Epoch 60/120
alternating training for epoch 60...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1695, Entity Loss: 0.0147, Total Loss: 0.0870
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1399
Epoch 60 - Train Loss: 0.0870, Val Loss: 2.0081
BLEU_1: 0.4140
BLEU_2: 0.2556
BLEU_3: 0.1746
BLEU_4: 0.1251
METEOR: 0.1693
ROUGE_L: 0.3344
entity_precision: 0.6046
entity_recall: 0.3070
entity_f1: 0.4072
Epoch 61/120
alternating training for epoch 61...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1534, Entity Loss: 0.0136, Total Loss: 0.0787
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1417
Epoch 61 - Train Loss: 0.0787, Val Loss: 2.0212
BLEU_1: 0.4058
BLEU_2: 0.2496
BLEU_3: 0.1708
BLEU_4: 0.1234
METEOR: 0.1669
ROUGE_L: 0.3323
entity_precision: 0.5807
entity_recall: 0.3135
entity_f1: 0.4072
Epoch 62/120
alternating training for epoch 62...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1523, Entity Loss: 0.0135, Total Loss: 0.0782
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1439
Epoch 62 - Train Loss: 0.0782, Val Loss: 2.0148
BLEU_1: 0.4164
BLEU_2: 0.2552
BLEU_3: 0.1717
BLEU_4: 0.1215
METEOR: 0.1703
ROUGE_L: 0.3351
entity_precision: 0.5990
entity_recall: 0.3027
entity_f1: 0.4022
Epoch 63/120
alternating training for epoch 63...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1562, Entity Loss: 0.0134, Total Loss: 0.0801
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1374
Epoch 63 - Train Loss: 0.0801, Val Loss: 2.0209
BLEU_1: 0.4132
BLEU_2: 0.2562
BLEU_3: 0.1754
BLEU_4: 0.1270
METEOR: 0.1709
ROUGE_L: 0.3385
entity_precision: 0.5983
entity_recall: 0.3064
entity_f1: 0.4053
Epoch 64/120
alternating training for epoch 64...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1471, Entity Loss: 0.0129, Total Loss: 0.0755
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1476
Epoch 64 - Train Loss: 0.0755, Val Loss: 2.0173
BLEU_1: 0.4129
BLEU_2: 0.2519
BLEU_3: 0.1683
BLEU_4: 0.1176
METEOR: 0.1694
ROUGE_L: 0.3312
entity_precision: 0.6112
entity_recall: 0.2998
entity_f1: 0.4023
Epoch 65/120
alternating training for epoch 65...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1555, Entity Loss: 0.0136, Total Loss: 0.0798
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1581
Epoch 65 - Train Loss: 0.0798, Val Loss: 2.0197
BLEU_1: 0.3935
BLEU_2: 0.2373
BLEU_3: 0.1577
BLEU_4: 0.1093
METEOR: 0.1617
ROUGE_L: 0.3248
entity_precision: 0.6059
entity_recall: 0.2892
entity_f1: 0.3915
Epoch 66/120
alternating training for epoch 66...
Report batches: 11, Entity batches: 11
Epoch Summary - Report Loss: 0.1597, Entity Loss: 0.0148, Total Loss: 0.0821
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1283
Epoch 66 - Train Loss: 0.0821, Val Loss: 2.0327
BLEU_1: 0.4198
BLEU_2: 0.2598
BLEU_3: 0.1789
BLEU_4: 0.1299
METEOR: 0.1714
ROUGE_L: 0.3351
entity_precision: 0.6023
entity_recall: 0.3056
entity_f1: 0.4054
Epoch 67/120
alternating training for epoch 67...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1529, Entity Loss: 0.0120, Total Loss: 0.0782
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1414
Epoch 67 - Train Loss: 0.0782, Val Loss: 2.0250
BLEU_1: 0.3993
BLEU_2: 0.2430
BLEU_3: 0.1643
BLEU_4: 0.1166
METEOR: 0.1629
ROUGE_L: 0.3259
entity_precision: 0.6073
entity_recall: 0.2902
entity_f1: 0.3927
Epoch 68/120
alternating training for epoch 68...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1508, Entity Loss: 0.0137, Total Loss: 0.0775
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1418
Epoch 68 - Train Loss: 0.0775, Val Loss: 2.0234
BLEU_1: 0.4096
BLEU_2: 0.2481
BLEU_3: 0.1661
BLEU_4: 0.1163
METEOR: 0.1673
ROUGE_L: 0.3288
entity_precision: 0.6031
entity_recall: 0.2992
entity_f1: 0.4000
Epoch 69/120
alternating training for epoch 69...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1445, Entity Loss: 0.0128, Total Loss: 0.0742
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1427
Epoch 69 - Train Loss: 0.0742, Val Loss: 2.0207
BLEU_1: 0.4153
BLEU_2: 0.2504
BLEU_3: 0.1662
BLEU_4: 0.1155
METEOR: 0.1699
ROUGE_L: 0.3305
entity_precision: 0.5950
entity_recall: 0.3043
entity_f1: 0.4027
Epoch 70/120
alternating training for epoch 70...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1483, Entity Loss: 0.0130, Total Loss: 0.0761
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1407
Epoch 70 - Train Loss: 0.0761, Val Loss: 2.0208
BLEU_1: 0.4224
BLEU_2: 0.2560
BLEU_3: 0.1699
BLEU_4: 0.1171
METEOR: 0.1727
ROUGE_L: 0.3333
entity_precision: 0.5959
entity_recall: 0.3115
entity_f1: 0.4091
Epoch 71/120
alternating training for epoch 71...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1423, Entity Loss: 0.0133, Total Loss: 0.0732
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1520
Epoch 71 - Train Loss: 0.0732, Val Loss: 2.0279
BLEU_1: 0.4082
BLEU_2: 0.2434
BLEU_3: 0.1593
BLEU_4: 0.1077
METEOR: 0.1667
ROUGE_L: 0.3273
entity_precision: 0.5999
entity_recall: 0.3047
entity_f1: 0.4042
Epoch 72/120
alternating training for epoch 72...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1583, Entity Loss: 0.0136, Total Loss: 0.0812
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1510
Epoch 72 - Train Loss: 0.0812, Val Loss: 2.0342
BLEU_1: 0.4026
BLEU_2: 0.2414
BLEU_3: 0.1588
BLEU_4: 0.1085
METEOR: 0.1654
ROUGE_L: 0.3255
entity_precision: 0.6012
entity_recall: 0.2986
entity_f1: 0.3990
Epoch 73/120
alternating training for epoch 73...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1534, Entity Loss: 0.0132, Total Loss: 0.0787
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1363
Epoch 73 - Train Loss: 0.0787, Val Loss: 2.0326
BLEU_1: 0.4137
BLEU_2: 0.2520
BLEU_3: 0.1693
BLEU_4: 0.1190
METEOR: 0.1696
ROUGE_L: 0.3319
entity_precision: 0.5928
entity_recall: 0.3039
entity_f1: 0.4018
Epoch 74/120
alternating training for epoch 74...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1445, Entity Loss: 0.0120, Total Loss: 0.0740
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1436
Epoch 74 - Train Loss: 0.0740, Val Loss: 2.0262
BLEU_1: 0.4153
BLEU_2: 0.2515
BLEU_3: 0.1659
BLEU_4: 0.1126
METEOR: 0.1694
ROUGE_L: 0.3296
entity_precision: 0.6032
entity_recall: 0.3015
entity_f1: 0.4020
Epoch 75/120
alternating training for epoch 75...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1467, Entity Loss: 0.0127, Total Loss: 0.0753
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1532
Epoch 75 - Train Loss: 0.0753, Val Loss: 2.0302
BLEU_1: 0.4037
BLEU_2: 0.2403
BLEU_3: 0.1560
BLEU_4: 0.1051
METEOR: 0.1644
ROUGE_L: 0.3251
entity_precision: 0.6020
entity_recall: 0.2941
entity_f1: 0.3952
Epoch 76/120
alternating training for epoch 76...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1526, Entity Loss: 0.0129, Total Loss: 0.0782
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1497
Epoch 76 - Train Loss: 0.0782, Val Loss: 2.0312
BLEU_1: 0.4104
BLEU_2: 0.2462
BLEU_3: 0.1605
BLEU_4: 0.1075
METEOR: 0.1664
ROUGE_L: 0.3279
entity_precision: 0.6029
entity_recall: 0.2998
entity_f1: 0.4005
Epoch 77/120
alternating training for epoch 77...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1491, Entity Loss: 0.0128, Total Loss: 0.0765
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1417
Epoch 77 - Train Loss: 0.0765, Val Loss: 2.0324
BLEU_1: 0.4242
BLEU_2: 0.2565
BLEU_3: 0.1687
BLEU_4: 0.1132
METEOR: 0.1720
ROUGE_L: 0.3323
entity_precision: 0.6007
entity_recall: 0.3070
entity_f1: 0.4063
Epoch 78/120
alternating training for epoch 78...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1405, Entity Loss: 0.0127, Total Loss: 0.0721
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1468
Epoch 78 - Train Loss: 0.0721, Val Loss: 2.0361
BLEU_1: 0.4044
BLEU_2: 0.2435
BLEU_3: 0.1603
BLEU_4: 0.1091
METEOR: 0.1644
ROUGE_L: 0.3242
entity_precision: 0.5980
entity_recall: 0.3002
entity_f1: 0.3998
Epoch 79/120
alternating training for epoch 79...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1456, Entity Loss: 0.0126, Total Loss: 0.0747
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1347
Epoch 79 - Train Loss: 0.0747, Val Loss: 2.0380
BLEU_1: 0.4195
BLEU_2: 0.2557
BLEU_3: 0.1707
BLEU_4: 0.1181
METEOR: 0.1702
ROUGE_L: 0.3320
entity_precision: 0.6024
entity_recall: 0.2986
entity_f1: 0.3993
Epoch 80/120
alternating training for epoch 80...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1386, Entity Loss: 0.0116, Total Loss: 0.0711
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1416
Epoch 80 - Train Loss: 0.0711, Val Loss: 2.0307
BLEU_1: 0.4237
BLEU_2: 0.2548
BLEU_3: 0.1668
BLEU_4: 0.1121
METEOR: 0.1723
ROUGE_L: 0.3289
entity_precision: 0.6015
entity_recall: 0.3080
entity_f1: 0.4074
Epoch 81/120
alternating training for epoch 81...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1481, Entity Loss: 0.0121, Total Loss: 0.0759
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1443
Epoch 81 - Train Loss: 0.0759, Val Loss: 2.0325
BLEU_1: 0.4156
BLEU_2: 0.2501
BLEU_3: 0.1635
BLEU_4: 0.1100
METEOR: 0.1694
ROUGE_L: 0.3281
entity_precision: 0.5974
entity_recall: 0.3019
entity_f1: 0.4011
Epoch 82/120
alternating training for epoch 82...
Report batches: 10, Entity batches: 10
Epoch Summary - Report Loss: 0.1474, Entity Loss: 0.0122, Total Loss: 0.0755
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1251
Epoch 82 - Train Loss: 0.0755, Val Loss: 2.0401
BLEU_1: 0.4281
BLEU_2: 0.2623
BLEU_3: 0.1772
BLEU_4: 0.1246
METEOR: 0.1727
ROUGE_L: 0.3337
entity_precision: 0.6022
entity_recall: 0.3068
entity_f1: 0.4065
Epoch 83/120
alternating training for epoch 83...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1322, Entity Loss: 0.0138, Total Loss: 0.0682
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1379
Epoch 83 - Train Loss: 0.0682, Val Loss: 2.0477
BLEU_1: 0.3849
BLEU_2: 0.2323
BLEU_3: 0.1565
BLEU_4: 0.1119
METEOR: 0.1582
ROUGE_L: 0.3222
entity_precision: 0.5887
entity_recall: 0.2689
entity_f1: 0.3692
Epoch 84/120
alternating training for epoch 84...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1411, Entity Loss: 0.0117, Total Loss: 0.0723
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1266
Epoch 84 - Train Loss: 0.0723, Val Loss: 2.0401
BLEU_1: 0.4221
BLEU_2: 0.2579
BLEU_3: 0.1730
BLEU_4: 0.1211
METEOR: 0.1733
ROUGE_L: 0.3332
entity_precision: 0.5980
entity_recall: 0.2978
entity_f1: 0.3976
Epoch 85/120
alternating training for epoch 85...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1274, Entity Loss: 0.0111, Total Loss: 0.0654
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1280
Epoch 85 - Train Loss: 0.0654, Val Loss: 2.0296
BLEU_1: 0.4271
BLEU_2: 0.2601
BLEU_3: 0.1732
BLEU_4: 0.1197
METEOR: 0.1759
ROUGE_L: 0.3332
entity_precision: 0.5915
entity_recall: 0.3002
entity_f1: 0.3983
Epoch 86/120
alternating training for epoch 86...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1378, Entity Loss: 0.0115, Total Loss: 0.0707
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1151
Epoch 86 - Train Loss: 0.0707, Val Loss: 2.0477
BLEU_1: 0.4351
BLEU_2: 0.2692
BLEU_3: 0.1841
BLEU_4: 0.1318
METEOR: 0.1776
ROUGE_L: 0.3396
entity_precision: 0.5922
entity_recall: 0.3090
entity_f1: 0.4061
Epoch 87/120
alternating training for epoch 87...
Report batches: 8, Entity batches: 8
Epoch Summary - Report Loss: 0.1239, Entity Loss: 0.0104, Total Loss: 0.0635
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1297
Epoch 87 - Train Loss: 0.0635, Val Loss: 2.0470
BLEU_1: 0.4174
BLEU_2: 0.2524
BLEU_3: 0.1673
BLEU_4: 0.1150
METEOR: 0.1701
ROUGE_L: 0.3290
entity_precision: 0.6020
entity_recall: 0.2953
entity_f1: 0.3963
Epoch 88/120
alternating training for epoch 88...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1349, Entity Loss: 0.0111, Total Loss: 0.0691
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1370
Epoch 88 - Train Loss: 0.0691, Val Loss: 2.0498
BLEU_1: 0.4113
BLEU_2: 0.2463
BLEU_3: 0.1606
BLEU_4: 0.1085
METEOR: 0.1667
ROUGE_L: 0.3258
entity_precision: 0.5991
entity_recall: 0.2951
entity_f1: 0.3954
Epoch 89/120
alternating training for epoch 89...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1414, Entity Loss: 0.0111, Total Loss: 0.0724
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1284
Epoch 89 - Train Loss: 0.0724, Val Loss: 2.0451
BLEU_1: 0.4124
BLEU_2: 0.2510
BLEU_3: 0.1672
BLEU_4: 0.1153
METEOR: 0.1684
ROUGE_L: 0.3281
entity_precision: 0.6019
entity_recall: 0.2931
entity_f1: 0.3942
Epoch 90/120
alternating training for epoch 90...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1326, Entity Loss: 0.0113, Total Loss: 0.0680
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1284
Epoch 90 - Train Loss: 0.0680, Val Loss: 2.0453
BLEU_1: 0.4138
BLEU_2: 0.2514
BLEU_3: 0.1673
BLEU_4: 0.1154
METEOR: 0.1687
ROUGE_L: 0.3286
entity_precision: 0.5942
entity_recall: 0.2994
entity_f1: 0.3982
Epoch 91/120
alternating training for epoch 91...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1390, Entity Loss: 0.0105, Total Loss: 0.0711
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1212
Epoch 91 - Train Loss: 0.0711, Val Loss: 2.0586
BLEU_1: 0.4146
BLEU_2: 0.2546
BLEU_3: 0.1723
BLEU_4: 0.1218
METEOR: 0.1686
ROUGE_L: 0.3294
entity_precision: 0.6006
entity_recall: 0.2982
entity_f1: 0.3985
Epoch 92/120
alternating training for epoch 92...
Report batches: 8, Entity batches: 8
Epoch Summary - Report Loss: 0.1238, Entity Loss: 0.0099, Total Loss: 0.0634
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1266
Epoch 92 - Train Loss: 0.0634, Val Loss: 2.0465
BLEU_1: 0.4219
BLEU_2: 0.2577
BLEU_3: 0.1713
BLEU_4: 0.1164
METEOR: 0.1718
ROUGE_L: 0.3318
entity_precision: 0.5974
entity_recall: 0.3056
entity_f1: 0.4043
Epoch 93/120
alternating training for epoch 93...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1306, Entity Loss: 0.0115, Total Loss: 0.0670
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1382
Epoch 93 - Train Loss: 0.0670, Val Loss: 2.0446
BLEU_1: 0.4047
BLEU_2: 0.2402
BLEU_3: 0.1563
BLEU_4: 0.1057
METEOR: 0.1637
ROUGE_L: 0.3215
entity_precision: 0.5849
entity_recall: 0.2962
entity_f1: 0.3932
Epoch 94/120
alternating training for epoch 94...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1390, Entity Loss: 0.0112, Total Loss: 0.0712
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1301
Epoch 94 - Train Loss: 0.0712, Val Loss: 2.0482
BLEU_1: 0.4136
BLEU_2: 0.2495
BLEU_3: 0.1643
BLEU_4: 0.1120
METEOR: 0.1690
ROUGE_L: 0.3315
entity_precision: 0.5985
entity_recall: 0.2990
entity_f1: 0.3988
Epoch 95/120
alternating training for epoch 95...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1303, Entity Loss: 0.0107, Total Loss: 0.0667
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1315
Epoch 95 - Train Loss: 0.0667, Val Loss: 2.0455
BLEU_1: 0.4172
BLEU_2: 0.2512
BLEU_3: 0.1644
BLEU_4: 0.1107
METEOR: 0.1706
ROUGE_L: 0.3293
entity_precision: 0.5924
entity_recall: 0.3076
entity_f1: 0.4050
Epoch 96/120
alternating training for epoch 96...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1330, Entity Loss: 0.0111, Total Loss: 0.0682
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1278
Epoch 96 - Train Loss: 0.0682, Val Loss: 2.0479
BLEU_1: 0.4089
BLEU_2: 0.2481
BLEU_3: 0.1646
BLEU_4: 0.1139
METEOR: 0.1670
ROUGE_L: 0.3302
entity_precision: 0.5982
entity_recall: 0.2919
entity_f1: 0.3923
Epoch 97/120
alternating training for epoch 97...
Report batches: 9, Entity batches: 9
Epoch Summary - Report Loss: 0.1332, Entity Loss: 0.0100, Total Loss: 0.0681
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1221
Epoch 97 - Train Loss: 0.0681, Val Loss: 2.0554
BLEU_1: 0.4234
BLEU_2: 0.2579
BLEU_3: 0.1723
BLEU_4: 0.1189
METEOR: 0.1721
ROUGE_L: 0.3324
entity_precision: 0.5954
entity_recall: 0.3105
entity_f1: 0.4081
Epoch 98/120
alternating training for epoch 98...
Report batches: 8, Entity batches: 8
Epoch Summary - Report Loss: 0.1231, Entity Loss: 0.0099, Total Loss: 0.0631
Computing difficulty scores for curriculum learning...
Updated curriculum ratio: 0.1267
Epoch 98 - Train Loss: 0.0631, Val Loss: 2.0505
BLEU_1: 0.4116
BLEU_2: 0.2506
BLEU_3: 0.1665
BLEU_4: 0.1144
METEOR: 0.1678
ROUGE_L: 0.3288
entity_precision: 0.5988
entity_recall: 0.2921
entity_f1: 0.3926
Validation performance didn't improve for 50 epochs. Training stops.
Loading best model for testing...
Test Results:
BLEU_1: 0.4425
BLEU_2: 0.2830
BLEU_3: 0.2031
BLEU_4: 0.1528
METEOR: 0.1823
ROUGE_L: 0.3594
entity_precision: 0.6117
entity_recall: 0.3296
entity_f1: 0.4284
Training completed!
